<!doctype html>
<html lang="fr">
<head>
  <link rel="icon" type="image/png" href="logo.png" />
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kfet INSA CVL ‚Äî Archive commandes</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            kfetBg: '#ffd0be',
            kfetAccent: '#fc8207'
          }
        }
      }
    }
  </script>

  <style>
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 0.6rem; border-bottom: 1px solid rgba(0,0,0,0.05); vertical-align: top; }
    th { text-align: left; font-weight: 600; color: #444; }
    .status-badge {
      padding: 0.25rem 0.5rem;
      border-radius: 0.375rem;
      font-size: 0.8rem;
      color: white;
      font-weight: 600;
      text-transform: capitalize;
    }
  </style>
</head>

<body class="bg-kfetBg text-gray-800 min-h-screen">
  <!-- HEADER -->
  <header class="bg-white shadow-sm">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
      <a href="index.html" class="flex items-center gap-3">
        <img src="logo.png" alt="Kfet logo" class="w-10 h-10 rounded-full object-cover" />
        <div><h1 class="text-lg font-semibold">Archive ‚Äî Kfet INSA CVL</h1></div>
      </a>
      <div class="flex gap-3">
        <a href="admin.html" class="text-sm text-gray-700 hover:underline">‚¨ÖÔ∏è Retour Admin</a>
        <a href="index.html" class="text-sm text-gray-700 hover:underline">üè† Retour √† la page principale</a>
      </div>
    </div>
  </header>

  <!-- MAIN -->
  <main class="max-w-6xl mx-auto p-4">
    <div class="bg-white rounded-md shadow p-4 mb-4 flex items-center justify-between">
      <h2 class="text-xl font-semibold">Commandes archiv√©es</h2>
      <button id="clearArchive" class="px-3 py-1 bg-kfetAccent text-white rounded hover:opacity-90 text-sm">üóëÔ∏è Vider l‚Äôarchive</button>
    </div>

    <div class="bg-white rounded-md shadow p-4 overflow-x-auto">
      <table id="archiveTable">
        <thead>
          <tr>
            <th>Pseudo</th>
            <th>Date / Heure</th>
            <th>Entr√©e</th>
            <th>Plat</th>
            <th>Dessert</th>
            <th>Boisson</th>
            <th>Commentaire</th>
            <th>Statut</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </main>

  <footer class="max-w-6xl mx-auto p-4 text-center text-sm text-gray-500">
    Archive des commandes (stock√©e localement)
  </footer>

  <script src="script.js"></script>
  <script>
    const tableBody = document.querySelector("#archiveTable tbody");
    const clearBtn = document.getElementById("clearArchive");

    function renderArchive() {
      const archived = kfet.loadArchive();
      tableBody.innerHTML = "";

      if (archived.length === 0) {
        const tr = document.createElement("tr");
        tr.innerHTML = `<td colspan="8" class="text-center text-gray-500 py-6">Aucune commande archiv√©e.</td>`;
        tableBody.appendChild(tr);
        return;
      }

      archived.forEach(o => {
        const tr = document.createElement("tr");

        const dt = new Date(o.datetimeISO);
        tr.innerHTML = `
          <td>${o.pseudo}</td>
          <td>${dt.toLocaleString("fr-FR", {hour:'2-digit',minute:'2-digit',day:'2-digit',month:'short'})}</td>
          <td>${o.entree || ''}</td>
          <td>${o.plat || ''}</td>
          <td>${o.dessert || ''}</td>
          <td>${o.boisson || ''}</td>
          <td>${o.comment || ''}</td>
        `;

        const statusTd = document.createElement("td");
        const badge = document.createElement("span");
        badge.className = "status-badge";

        switch (o.status) {
          case "termin√©e":
            badge.textContent = "Termin√©e";
            badge.style.background = "#16a34a"; break;
          case "annul√©e":
            badge.textContent = "Annul√©e";
            badge.style.background = "#ef4444"; break;
          case "jamais venue":
            badge.textContent = "Jamais venue";
            badge.style.background = "#6b7280"; break;
          default:
            badge.textContent = o.status || "Inconnue";
            badge.style.background = "#d1d5db";
        }

        statusTd.appendChild(badge);
        tr.appendChild(statusTd);
        tableBody.appendChild(tr);
      });
    }

    clearBtn.addEventListener("click", () => {
      if (confirm("Supprimer d√©finitivement toutes les commandes archiv√©es ?")) {
        localStorage.removeItem("kfet_orders_archive");
        renderArchive();
      }
    });

    renderArchive();
  </script>
</body>
</html>
